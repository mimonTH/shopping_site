<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="description" content="">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0 shrink-to-fit=no">  
        
        <title>ChristinAura - Cosmetic & Fragrance </title>
        <!-- Favicon  -->
        <link rel="icon" href="img/shop_img/favicon.ico">
        
        <!-- css  -->
        <link rel="stylesheet" href="css/style.css">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
    </head>
    <body>
        <!-- whole page/3 sections -->
        <div class="main_content_area">
            <!-- nav sections -->
            <header class="header_area">
                <div class="logo">
                    <a href="shop.html">
                        <img src="img/shop_img/logo.png" alt="Page Logo">
                    </a> 
                </div>
                <nav class="navi_section">
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li class="active"><a href="shop.html">Shop</a></li>
                        
                    </ul>
                </nav>
            </header>
            <!-- nav sections -->
            <!-- search by category section -->
            <div class="sidebar_area">
                <div class="sidebar_main_area">
                    <!--search bar section-->
                    <div class="sidebar_search_area mb-20">
                        <input name="search_box" type="text" id="searchbox_id" class="sidebar_search" placeholder="キーワードで検索">
                    </div>
                    <!-- search by brand section -->
                    <div class="widget brands mb-50">
                        <!-- Brands Title -->
                        <h6 class="widget_title mb-30">Brands</h6>
                        <div class="widget_desc">
                            <!-- Select All Check -->
                            <div class="form_check">
                                <input class="form_check_input" type="checkbox" value="" id="select_all">
                                <label class="form_check_label" for="select_all" id="select_all_label">Select All</label>
                            </div>
                            <!-- First 4 visible checkboxes -->
                            <!-- Single Form Check -->
                             <div class="form_check">
                                <input class="form_check_input" type="checkbox" value="" id="hermes">
                                <label class="form_check_label" for="hermes">Hermès</label>
                            </div>
                            <!-- Single Form Check -->
                            <div class="form_check">
                                <input class="form_check_input" type="checkbox" value="" id="burberry">
                                <label class="form_check_label" for="burberry">Burberry</label>
                            </div>
                            <!-- Single Form Check -->
                            <div class="form_check">
                                <input class="form_check_input" type="checkbox" value="" id="chanel">
                                <label class="form_check_label" for="chanel">Chanel</label>
                            </div>
                            <!-- Single Form Check -->
                            <div class="form_check">
                                <input class="form_check_input" type="checkbox" value="" id="dior">
                                <label class="form_check_label" for="dior">Dior</label>
                            </div>
                            <!-- First 4 visible checkboxes -->
                            <!-- Hidden section -->
                            <div class="more_checks" style="display: none;">   
                            <!-- Single Form Check -->
                            <div class="form_check">
                                <input class="form_check_input" type="checkbox" value="" id="ysl">
                                <label class="form_check_label" for="ysl">YSL</label>
                            </div>
                           <!-- Single Form Check -->
                            <div class="form_check">
                                <input class="form_check_input" type="checkbox" value="" id="givenchy">
                                <label class="form_check_label" for="givenchy">Givenchy</label>
                            </div>
                            
                            <!-- Single Form Check -->
                            <div class="form_check">
                                <input class="form_check_input" type="checkbox" value="" id="tomford">
                                <label class="form_check_label" for="tomford">Tom Ford</label>
                            </div>
                            <!-- Single Form Check -->
                            <div class="form_check">
                                <input class="form_check_input" type="checkbox" value="" id="elizabetharden">
                                <label class="form_check_label" for="elizabetharden">Elizabeth Arden</label>
                            </div>
                            </div>
                            <!-- Hidden section -->
                            <!-- Toggle Button -->
                            <a class="see_more_brand_btn mb-50" href="javascript:void(0);">See More</a>

                            
                            <!-- <div class="widget price mb-50"> -->
                                <!-- Widget Title -->
                                <!-- <h6 class="widget_title mb-30">Price</h6>
                                <div class="widget_desc">
                                    <div class="slider-range">
                                        <div 
                                            data-min="10" 
                                            data-max="500" 
                                            data-unit="$" 
                                            class="mb-30 slider_price_range ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all"
                                            data-value-min="10" 
                                            data-value-max="500" 
                                            data-label-result="">
                                        </div>
                                        <div class="price_range">$10 - $500</div>
                                    </div> -->
                                <!-- </div>
                            </div> -->
                        </div>
                    </div>
                    <!-- search by category section -->
                    <div class="widget categories mb-50">
                        <!-- Categories title -->
                        <h6 class="widget_title mb-30">Categories</h6>
                            <ul class="category_list">
                                <li class="main_cat">
                                    <span class="toggle">Cosmetics</span>
                                    <ul class="small_cat">
                                        <li>
                                        <div class="form_check mt-15">
                                            <input class="form_check_input" type="checkbox" value="" id="foundation">
                                            <label class="form_check_label" for="foundation">Foundation</label>
                                        </div>
                                        </li>
                                        <li>
                                        <div class="form_check mt-15">
                                            <input class="form_check_input" type="checkbox" value="" id="powder">
                                            <label class="form_check_label" for="powder">Powder</label>
                                        </div>
                                        </li>
                                        <li>
                                        <div class="form_check mt-15">
                                            <input class="form_check_input" type="checkbox" value="" id="blush">
                                            <label class="form_check_label" for="blush">Blush</label>
                                        </div>
                                        </li>
                                        <li>
                                        <div class="form_check mt-15">
                                            <input class="form_check_input" type="checkbox" value="" id="lipstick">
                                            <label class="form_check_label" for="lipstick">Lipstick</label>
                                        </div>
                                        </li>
                                    </ul>
                                </li>
                                <li class="main_cat">
                                    <span class="toggle">Fragrance</span>
                                    <ul class="small_cat">
                                        <li>
                                            <div class="form_check mt-15">
                                            <input class="form_check_input" type="checkbox" value="" id="men_frag">
                                            <label class="form_check_label" for="men_frag">Men's Fragrance</label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form_check mt-15">
                                            <input class="form_check_input" type="checkbox" value="" id="women_frag">
                                            <label class="form_check_label" for="women_frag">Women's Fragrance</label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form_check mt-15">
                                            <input class="form_check_input" type="checkbox" value="" id="unisex_frag">
                                            <label class="form_check_label" for="unisex_frag">Unisex</label>
                                            </div>
                                        </li>
                                        
                                        
                                    </ul>
                                    
                                </li>
                            </ul> 
                        <!-- <div class="cos_select_area mb-20">
                            <form　id="cos_form_id" class="categories_dd">
                                <select id="cosmetics_select option" class="cat_cos_dropdown">
                                    <option value="">Cosmetics</option>
                                    <option value="Foundation">Foundation</option>
                                    <option value="Powder">Powder</option>
                                    <option value="Blush">Blush</option>
                                    <option value="Lipstick">Lipstick</option>
                                </select>
                            </form>
                        </div>
                        <div class="cos_select_area  mb-30">
                            <form　id="frag_form_id" class="categories_dd">
                                <select id="fragrance_select option" class="cat_frag_dropdown">
                                    <option value="">Fragrance</option>
                                    <option value="Men's Fragrance">Men's Fragrance</option>
                                    <option value="Women's Fragrance">Women's Fragrance</option>
                                    <option value="Unisex">Unisex</option>
                                </select>
                            </form>
                        </div> -->
                    </div>
                    <div class="action_buttons mb-50">
                        <button id="action_search_btn" class="sidebar_search_btn" type="button">検索</button>
                        <button id="action_clear_btn" type="button">クリア</button>
                    </div>
                </div>
            </div>
            <!-- search by category section -->
            <!-- product display section -->
            <div class="product_display_area section-padding-100">
                <!-- Controls Area-->
                <div class="product_controls_row mb-30">
                    <div class="view option" style="display: none;">
                        <p> View </p>
                        <form>
                            <select id="view_count">
                                <option class="selected" selected>10</option>
                                <option>20</option>
                                <option>30</option>
                                <option>40</option>
                                <option>50</option>
                                <option>100</option>
                            </select>
                        </form>
                    </div>
                    <div class="sorty option">
                        <p> 並べ替え </p>
                        <form>   
                            <select id="sorty_option">
                                <option></option>
                                <option>安い順</option>
                                <option>高い順 </option>
                            </select> 
                        </form>  
                    </div>
                </div>
                <!-- Controls Area -->
                <!-- Search Result not found area -->
                 <div class="searchRes_not_found">
                    
                </div>
                <!-- Search Result not found area -->
                <!-- Products Area -->
                <div class="product_grid_row">
                    
                </div>
                <!-- Products Area -->
                <!-- Pagination Area -->
                <div class="pag_row">
                    <nav aria-label="navigation">
                        <ul class="pagination mt-50">
                            
                        </ul>
                    </nav>

                </div>
            </div>
            <!-- product display section -->
            <!-- product detail modal section -->
            <div class="productDetail_Modal" id="productDetailModal">
                <div class="modal_content">
                    <span class="close_btn">&times;</span>
                    <div class="modal_content_inner">
                        <img id="modal_product_img" alt="Product Image">
                        <div class="modal_product_info">
                            <h6 id="modal_brand"></h6>
                            <p id="modal_name"></p>
                            <p id="modal_price"></p>
                            <p id="modal_code"></p>
                            <div class="rating" id="modal_rating"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- product detail modal section -->
        </div>
        <footer class="footer_area">
            <div class="footer_container">
                <div class="footer_col">
                <h6>About Us</h6>
                <p>We offer a curated selection of beauty and skincare products from trusted brands. Our mission is to help you find what fits your unique style.</p>
                </div>

                <div class="footer_col">
                <h6>Quick Links</h6>
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Shop</a></li>
                    <li><a href="#">About</a></li>
                    <li><a href="#">Contact</a></li>
                    <li><a href="#">FAQs</a></li>
                </ul>
                </div>

                <div class="footer_col">
                <h6>Customer Support</h6>
                <ul>
                    <li><a href="#">Shipping Policy</a></li>
                    <li><a href="#">Return Policy</a></li>
                    <li><a href="#">Terms & Conditions</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                </ul>
                </div>

                <div class="footer_col">
                <h6>Contact</h6>
                <ul>
                    <li>Email: customersupport@example.com</li>
                    <li>Phone: +81-80-1234-5678</li>
                </ul>
                <div class="social_icons">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                </div>
                </div>
            </div>

            <div class="footer_bottom">
                © 2025 ChristinAura. All Rights Reserved.
            </div>
            </footer>
        <!-- whole page -->
    </body>
    <script>
        let allProducts = []; // keep all data 
        let products = []; 
        let filteredProducts = [];
        let sortedProducts = []; 
        let allSortedProducts = [];
        
        // Product data fetching    
        fetch('product_data.json')
        .then(response => response.json())
        .then(data => {
            allProducts = data;           // store original data
            products = [...allProducts];  // shallow copy
            filteredProducts = [...allProducts];

            setPagination(products);
            displayProducts(1, products);
        })
        .catch(err => console.error('Failed to load products:', err));

        //search area
        const searchBox = document.getElementById('searchbox_id');
        const searchBtn = document.getElementById('action_search_btn');
        
        function runSearch(inputKeyword){
            
            inputKeyword = searchBox.value.trim().toLowerCase();
            // Clear previous "no results" message (if any)
            const oldRes = document.querySelector('.no_results');
            if (oldRes) oldRes.style.display = 'none';
            if(inputKeyword === ''){
                // empty input → reset to all products
                products = [...allProducts];
                filteredProducts = [...allProducts];
                allSortedProducts = [];
                setPagination(products);
                displayProducts(1, products);
                return;
            }
            const searchRes = allProducts.filter(p => 
                p.name.toLowerCase().includes(inputKeyword) ||
                p.brand.toLowerCase().includes(inputKeyword) ||
                (p.code && p.code.toLowerCase().includes(inputKeyword))
            );
            if (searchRes.length === 0) {
                document.querySelector('.searchRes_not_found').innerHTML = `<p class="no_results">No products found for "<strong>${inputKeyword}</strong>"</p>`;
                document.querySelector('.product_grid_row').innerHTML = '';
                document.querySelector('.pagination').innerHTML = '';
                return;
            }
            else{
                products = [...searchRes];
                filteredProducts = [...searchRes];
                allSortedProducts = [...searchRes];
            }
    }
        // Button click search
        searchBtn.addEventListener('click', () => runSearch(searchBox.value));
        // Auto search reset when cleared
        searchBox.addEventListener('input', () => {
            if (searchBox.value.trim() === '') {
                runSearch('');
            }
        })

        //search area
        //clear area
        const clearBtn = document.getElementById('action_clear_btn');
        clearBtn.addEventListener('click', () => {
            //clear search box
            document.getElementById('searchbox_id').value = '';
            //clear checkbox values of the brands
            document.querySelectorAll('.brands .form_check_input').forEach( chkbox => chkbox.checked = false)
            document.getElementById('select_all_label').textContent = 'Select All';

            //clear checkbox values of the categories
            document.querySelectorAll('.categories .form_check_input').forEach( chkbox => chkbox.checked = false)

            const moreChkBox = document.querySelector('.more_checks');
            moreChkBox.style.display = 'none';

            const seeMoreBtn = document.querySelector('.see_more_brand_btn');
            seeMoreBtn.textContent = 'See More';
            runSearch('');
        })
        // JS for See More/See Less
        const toggleLink = document.querySelector('.see_more_brand_btn');
        const moreChecks = document.querySelector('.more_checks');
        toggleLink.addEventListener('click',()=>{
            const isVisible = moreChecks.style.display === 'block';
            moreChecks.style.display = isVisible? 'none' : 'block';
            toggleLink.textContent = isVisible? 'See more' : 'See Less'
        });
        //JS for Select All/Deselect All
        const selectAllCheckBox = document.getElementById('select_all');
        const selectAllLabel = document.getElementById('select_all_label');
        const allBrandsCheckBox = document.querySelectorAll('.form_check_input:not(#select_all)');

        selectAllCheckBox.addEventListener('change',()=>{
            allBrandsCheckBox.forEach(brandsCheckbox => {
                brandsCheckbox.checked = selectAllCheckBox.checked; 
                selectAllLabel.textContent = selectAllCheckBox.checked ? 'Deselect All' : 'Select All';
            });
        });

       


        //JS for Price Range Slider

        document.querySelectorAll('.category_list .toggle').forEach(toggle => {
            toggle.addEventListener('click', () => {
                toggle.classList.toggle('active');
                const nextUl = toggle.nextElementSibling;
                if (nextUl && nextUl.tagName === 'UL') {
                nextUl.style.display = nextUl.style.display === 'block' ? 'none' : 'block';
                }
            });
        });

      

        let products_per_page = parseInt(document.getElementById('view_count').value);   

        const viewCountSelect = document.getElementById('view_count')
        viewCountSelect.addEventListener('change',() => {    
            products_per_page = parseInt(viewCountSelect.value)

            // //Reset the slider if the slider is moved
            // const $slider = $(".slider_price_range");
            // const min = $slider.slider("option","min");
            // const max = $slider.slider("option","max");
            // // reset slider handles
            // $slider.slider("values",[min,max]);
            // var res = "$"+min+' - $'+max;
            // $slider.closest('.slider-range').find('.price_range').html(res)

            setPagination(products);
            displayProducts(1,products);
        })


        //JS for Price Range Slider
        //UI
        $('.slider_price_range').each(function(){
            var min = jQuery(this).data('min');
            var max = jQuery(this).data('max');
            var unit = jQuery(this).data('unit');
            var min_value = jQuery(this).data('value-min');
            var max_value = jQuery(this).data('value-max');
            var label_result = jQuery(this).data('label-result');
            var t = $(this);
            $(this).slider({
                range: true,
                min:min,
                max:max,
                values:[min_value, max_value],
                slide: function (event, ui){
                    var res = label_result+" "+unit+ ui.values[0]+' - '+unit+ ui.values[1];
                    console.log(t);
                    t.closest('.slider-range').find('.price_range').html(res);

                    //filter when slider moves
                    filterProductBySlider(ui.values[0],ui.values[1]);
                }
            })
        })

        //Filter By Price Slider
        function filterProductBySlider(minPrice, maxPrice) {
            if(allSortedProducts.length > 0){
                filteredProducts = allSortedProducts.filter(p => {
                const price = parseInt(p.price.replace('$',''));
                return price >= minPrice && price <= maxPrice;
            });
            products = [...filteredProducts]; // update current view only 
            }
            else{
                filteredProducts = allProducts.filter(p => {
                    const price = parseInt(p.price.replace('$',''));
                    return price >= minPrice && price <= maxPrice;
                });
                products = [...filteredProducts]; // update current view only
            }
            
            setPagination(filteredProducts);
            displayProducts(1, filteredProducts);
        }
        //Sorty By Price Selector
        const sortSelect = document.getElementById('sorty_option');
        
        sortSelect.addEventListener('change', () => {
            const sortValue = sortSelect.value;
            Array.from(sortSelect.options).forEach( opt =>
                opt.classList.remove('selected')
            )
            allSortedProducts = [...allProducts];
            sortSelect.options[sortSelect.selectedIndex].classList.add('selected');
            if(filteredProducts.length >0){
                sortedProducts = [...products]; // sort current filtered view
            }
            else{
                sortedProducts = [...allProducts]; // sort current filtered view
            }
            if (sortValue === '安い順') {
                sortedProducts.sort((a, b) => parseFloat(a.price.replace('¥', '')) - parseFloat(b.price.replace('¥', '')));
                allSortedProducts.sort((a, b) => parseFloat(a.price.replace('¥', '')) - parseFloat(b.price.replace('¥', '')));
            } else if (sortValue === '高い順') {
                sortedProducts.sort((a, b) => parseFloat(b.price.replace('¥', '')) - parseFloat(a.price.replace('¥', '')));
                allSortedProducts.sort((a, b) => parseFloat(b.price.replace('¥', '')) - parseFloat(a.price.replace('¥', '')));
            }
            products = [...sortedProducts]; // update current view only
            setPagination(sortedProducts);
            displayProducts(1, sortedProducts);
        });



//Initialize dynamic pagination based on the number of products
function setPagination(data){
const total_products = data.length
const total_pages = Math.ceil(total_products/products_per_page)
const paginationContainer = document.querySelector('.pagination');
paginationContainer.innerHTML = ''; //
for(let i=1 ; i <= total_pages; i++){
    const li = document.createElement('li');
    li.classList.add('page_item');
    if(i === 1) li.classList.add('active');

    const a = document.createElement('a');
    a.classList.add('page_link');
    a.href = '#';
    a.textContent = i.toString().padStart(2,'0')
    

    a.addEventListener('click',(e)=>{
        e.preventDefault();
        document.querySelectorAll('.page_item').forEach(item => item.classList.remove('active'));
        li.classList.add('active');
        displayProducts(i,data);
    })

    li.appendChild(a);
    paginationContainer.appendChild(li);

}
}
//rating star
function getStarsHTML(rating){
    const fullStars = Math.floor(rating);
    const halfStars = rating % 1 >= 0.5;
    const emptyStars = 5 - fullStars - (halfStars ? 1:0);

    let html = '';
    //for full star
    for(let i = 0; i< fullStars; i++) html +='<i class ="fa fa-star"></i>';
    //for half star
    for(let i = 0; i< halfStars; i++) html +='<i class ="fa fa-star-half-alt"></i>';
    //for empty star
    for(let i = 0; i< emptyStars; i++) html +='<i class ="fa fa-star-o"></i>';
    return html;
}
// Function to show products per page
function displayProducts(pageNumber,data){
    
const start = (pageNumber - 1) * products_per_page;
    const end = start + products_per_page;
    const pageProducts = data.slice(start, end);
const productContainer = document.querySelector('.product_grid_row');
    let html = '';
    pageProducts.forEach((p,i) => {
        const stars = getStarsHTML(p.rating);
        const globalIndex = start + i;
        html += `
        <div class="product_card" data-index = "${globalIndex}">
            <img src="${p.img}" alt="${p.name}">
            <h6 class="brand">${p.brand}</h6>
            <p class="name">${p.name}</p>
            <p class="price"><span>Price :</span> ${p.price}</p>
            <p class="code">Code : ${p.code}</p>
            <div class="rating">${stars}</div>
        </div>
        `;
    });
    productContainer.innerHTML = html;

    //=== modal for product detial ===
    document.querySelectorAll('.product_card').forEach( card => {
        card.addEventListener('click', () =>{
            const i = parseInt(card.dataset.index);
            const product = data[i];
            console.log(product);
            openModal(product);
        })
    })
}
    const modal = document.getElementById('productDetailModal');
    const closeBtn = document.querySelector('.close_btn');
    function openModal(productInfo){
        document.getElementById('modal_product_img').src = productInfo.img;
        document.getElementById('modal_brand').textContent = productInfo.brand;
        document.getElementById('modal_name').textContent = productInfo.name;
        document.getElementById('modal_price').innerHTML = `<span>Price :</span> ${productInfo.price}`;
        document.getElementById('modal_code').textContent = 'Code : '+ productInfo.code;
        const stars = getStarsHTML(productInfo.rating);
        document.getElementById('modal_rating').innerHTML= stars
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';
    }
    closeBtn.addEventListener('click', () => {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto'
    });

    window.addEventListener('click', (e) => {
    if (e.target === modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto'
    }
    });


    </script>

    
</html>